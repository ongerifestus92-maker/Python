def error_handling_lab():
    """
    Asks user for filename and handles various errors
    """
    print("\nğŸ§ª ERROR HANDLING LAB")
    print("=" * 40)
    
    while True:
        filename = input("\nğŸ“‚ Enter the filename to read (or 'quit' to exit): ").strip()
        
        if filename.lower() == 'quit':
            print("ğŸ‘‹ Exiting the program. Goodbye!")
            break
        
        if not filename:
            print("âš ï¸  Please enter a filename.")
            continue
        
        try:
            # Try to open and read the file
            with open(filename, 'r', encoding='utf-8') as file:
                content = file.read()
            
            # If successful, process and display file info
            display_file_info(filename, content)
            break
            
        except FileNotFoundError:
            print(f"âŒ Error: The file '{filename}' was not found.")
            print("ğŸ’¡ Please check the filename and try again.")
            
        except PermissionError:
            print(f"ğŸš« Error: Permission denied to read '{filename}'.")
            print("ğŸ’¡ Check file permissions or try a different file.")
            
        except UnicodeDecodeError:
            print(f"ğŸ”¤ Error: Cannot decode '{filename}'. It might be a binary file.")
            print("ğŸ’¡ Try a text file or specify correct encoding.")
            
        except IsADirectoryError:
            print(f"ğŸ“ Error: '{filename}' is a directory, not a file.")
            
        except IOError as e:
            print(f"ğŸ’¥ I/O Error: {e}")
            
        except Exception as e:
            print(f"âš ï¸  Unexpected error: {e}")
        
        # Offer to create the file if it doesn't exist
        if input("\nWould you like to create this file? (y/n): ").lower() == 'y':
            create_user_file(filename)

def display_file_info(filename, content):
    """Display information about the successfully read file"""
    lines = content.splitlines()
    words = content.split()
    
    print(f"\nâœ… SUCCESSFULLY READ: {filename}")
    print("=" * 50)
    print(f"ğŸ“Š File Statistics:")
    print(f"   â€¢ Lines: {len(lines)}")
    print(f"   â€¢ Words: {len(words)}")
    print(f"   â€¢ Characters: {len(content)}")
    
    # Show preview of content
    print(f"\nğŸ“„ Content Preview (first 3 lines):")
    print("-" * 30)
    for i, line in enumerate(lines[:3], 1):
        print(f"{i}: {line[:80]}{'...' if len(line) > 80 else ''}")
    
    if len(lines) > 3:
        print(f"... and {len(lines) - 3} more lines")

def create_user_file(filename):
    """Allow user to create a new file with custom content"""
    print(f"\nğŸ“ Creating new file: {filename}")
    print("Enter your content (press Enter twice to finish):")
    
    content_lines = []
    while True:
        line = input()
        if line == "" and content_lines and content_lines[-1] == "":
            break
        content_lines.append(line)
    
    # Remove the last empty line
    content_lines = content_lines[:-1] if content_lines else []
    final_content = "\n".join(content_lines)
    
    try:
        with open(filename, 'w') as file:
            file.write(final_content)
        print(f"âœ… File '{filename}' created successfully!")
    except Exception as e:
        print(f"âŒ Could not create file: {e}")

# Run the error handling lab
if __name__ == "__main__":
    error_handling_lab()
